{% extends 'base.html' %}
{% load static %}

{% block title %}Loan Requests{% endblock %}

{% block sidebar %}

<link rel="stylesheet" href="{% static 'css/loan_requests.css' %}">

<li class="sidebar-item">
    <a href="/salary_details" class="sidebar-link mt-2 w3-bar-item w3-button tablink" style='color: black;'>
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-currency-rupee mx-3" viewBox="0 0 16 16">
            <path d="M4 3.06h2.726c1.22 0 2.12.575 2.325 1.724H4v1.051h5.051C8.855 7.001 8 7.558 6.788 7.558H4v1.317L8.437 14h2.11L6.095 8.884h.855c2.316-.018 3.465-1.476 3.688-3.049H12V4.784h-1.345c-.08-.778-.357-1.335-.793-1.732H12V2H4z"/>
          </svg>
        Salary Details
    </a>
</li>

<li class="sidebar-item">
    <a href="/expense_claims" class="sidebar-link mt-2 w3-bar-item w3-button tablink" style='color: black;'>
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-graph-up-arrow mx-3" viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M0 0h1v15h15v1H0zm10 3.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-1 0V4.9l-3.613 4.417a.5.5 0 0 1-.74.037L7.06 6.767l-3.656 5.027a.5.5 0 0 1-.808-.588l4-5.5a.5.5 0 0 1 .758-.06l2.609 2.61L13.445 4H10.5a.5.5 0 0 1-.5-.5"/>
        </svg>
        Expense Claims
    </a>
</li>

<li class="sidebar-item">
    <a href="/tax_deduction" class="sidebar-link mt-2 w3-bar-item w3-button tablink" style='color: black;'>
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-currency-exchange mx-3" viewBox="0 0 16 16">
            <path d="M0 5a5 5 0 0 0 4.027 4.905 6.5 6.5 0 0 1 .544-2.073C3.695 7.536 3.132 6.864 3 5.91h-.5v-.426h.466V5.05q-.001-.07.004-.135H2.5v-.427h.511C3.236 3.24 4.213 2.5 5.681 2.5c.316 0 .59.031.819.085v.733a3.5 3.5 0 0 0-.815-.082c-.919 0-1.538.466-1.734 1.252h1.917v.427h-1.98q-.004.07-.003.147v.422h1.983v.427H3.93c.118.602.468 1.03 1.005 1.229a6.5 6.5 0 0 1 4.97-3.113A5.002 5.002 0 0 0 0 5m16 5.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0m-7.75 1.322c.069.835.746 1.485 1.964 1.562V14h.54v-.62c1.259-.086 1.996-.74 1.996-1.69 0-.865-.563-1.31-1.57-1.54l-.426-.1V8.374c.54.06.884.347.966.745h.948c-.07-.804-.779-1.433-1.914-1.502V7h-.54v.629c-1.076.103-1.808.732-1.808 1.622 0 .787.544 1.288 1.45 1.493l.358.085v1.78c-.554-.08-.92-.376-1.003-.787zm1.96-1.895c-.532-.12-.82-.364-.82-.732 0-.41.311-.719.824-.809v1.54h-.005zm.622 1.044c.645.145.943.38.943.796 0 .474-.37.8-1.02.86v-1.674z"/>
        </svg>
        Tax Deduction
    </a>
</li>

<li class="sidebar-item">
    <a href="/loan_requests" class="sidebar-link mt-2 w3-bar-item w3-button tablink" style='color: black;'>
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-bank mx-3" viewBox="0 0 16 16">
            <path d="m8 0 6.61 3h.89a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.5.5H15v7a.5.5 0 0 1 .485.38l.5 2a.498.498 0 0 1-.485.62H.5a.498.498 0 0 1-.485-.62l.5-2A.5.5 0 0 1 1 13V6H.5a.5.5 0 0 1-.5-.5v-2A.5.5 0 0 1 .5 3h.89zM3.777 3h8.447L8 1zM2 6v7h1V6zm2 0v7h2.5V6zm3.5 0v7h1V6zm2 0v7H12V6zM13 6v7h1V6zm2-1V4H1v1zm-.39 9H1.39l-.25 1h13.72z"/>
        </svg>
        Loan request
    </a>
</li>
{% endblock %}

{% block content %}
<div class="mx-auto loan-container">

    <div class="row mx-auto container-fluid">

        <div class="col form-control mt-2 pb-2" style="background-color:#f1f1f1; ; shadow-lg">

            <div class='text'>
                <h5 class="text-center mx-auto mt-3">Loan Request Form</h5>
                <hr class='text-center mx-auto col-8'>
            </div>

            <form action="{% url 'submit_loan_request' %}" method="post" enctype="multipart/form-data">
                {% csrf_token %}

                <div class='col'>

                    <div class="mt-3">
                        <label for="loan_type" class="form-label">Loan Type</label>
                        <select id="loan_type" name="loan_type" class='form-control text-center' required>
                            <option value="" disabled selected hidden>Choose loan type</option>
                            <option value="Personal Loan">Personal Loan</option>
                            <option value="Home Loan">Home Loan</option>
                            <option value="Education Loan">Education Loan</option>
                        </select>
                    </div>

                    <div class="mt-3">
                        <label for="date" class="form-label">Date</label>
                        <input type="date" id="date" name="date" class="form-control" required style="border-color: rgb(119, 119, 119);">
                    </div>
                    
                    <div class="mt-3">
                        <label for="loan_amount" class="form-label">Requested Loan Amount (Rs)</label>
                        <input  type="number" class='form-control' id="loan_amount" name="loan_amount" placeholder="Enter amount" required style="border-color:rgb(119, 119, 119);">
                    </div>

                    <div class="mt-3">
                        <label for="repayment_duration" class="form-label">Repayment Duration (months)</label>
                        <input type="number" id="repayment_duration" name="repayment_duration" class='form-control' placeholder="e.g., 24" required style="border-color:rgb(119, 119, 119);">
                    </div>

                    <div class="mt-3">
                        <label for="bill_no" class="form-label">Interest Rate (%)</label>
                        <input type="number" id="interest_rate" name="interest_rate" class='form-control' placeholder="e.g., 5" style="border-color:rgb(119, 119, 119);" required>
                    </div>

                </div>

                <div class="mt-3 text-center">
                    <button type="submit" class='btn btn-dark my-1'>Submit  Loan Request</button>
                </div>

            </form>

        </div>

        <div class="col-12 d-none d-md-block" class="loan-summary">

            <div class='text-center'>
                <h5 class="text-center mx-auto mt-3">Loan Summary</h5>
                <hr class='text-center mx-auto col-9'>
            </div>

            <table>
                <thead>
                    <tr style="background-color:#f1f1f1;">
                        <th>Loan Type</th>
                        <th>Date</th>
                        <th>Amount Requested</th>
                        <th>Duration (months)</th>
                        <th>Interest Rate (%)</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for loan in loans %}
                    <tr>
                        <td>{{ loan.loan_type }}</td>
                        <td>{{ loan.date }}</td>
                        <td>{{ loan.loan_amount }}</td>
                        <td>{{ loan.repayment_duration }}</td>
                        <td>{{ loan.interest_rate }}</td>
                        <td>{{ loan.status }}</td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="6">No loan requests found.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>

        </div>
        <div class="col-12 loan-summary d-block d-md-none">
            <div class='text-center'>
                <h5 class="text-center mx-auto mt-3">Loan Summary</h5>
                <hr class='text-center mx-auto col-9'>
            </div>
        
            <div class="table-responsive">
                <table class="table table-hover">
                    <thead>
                        <tr class="table-light">
                            <th scope="col">Loan Type</th>
                            <th scope="col">Date</th>
                            <th scope="col">Amount Requested</th>
                            <th scope="col">Duration (months)</th>
                            <th scope="col">Interest Rate (%)</th>
                            <th scope="col">Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for loan in loans %}
                        <tr>
                            <td>{{ loan.loan_type }}</td>
                            <td>{{ loan.date }}</td>
                            <td>{{ loan.loan_amount }}</td>
                            <td>{{ loan.repayment_duration }}</td>
                            <td>{{ loan.interest_rate }}</td>
                            <td>{{ loan.status }}</td>
                        </tr>
                        {% empty %}
                        <tr>
                            <td colspan="6" class="text-center">No loan requests found.</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

</div>

{% endblock %}